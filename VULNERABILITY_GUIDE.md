# Mobile Shop - TryHackMe Vulnerable Web Application

A deliberately vulnerable mobile shop website designed for cybersecurity training and TryHackMe rooms.

## üö® **WARNING: This application contains intentional vulnerabilities for educational purposes only!**

## Vulnerabilities Included

### 1. **SQL Injection** - Login Form
- **Location**: Login page (`/login.html`)
- **Vulnerability**: Unsanitized user input in login form
- **Flag**: `THM{SQL_INJECTION_SUCCESS}`

**Exploitation:**
1. Go to the login page
2. In the email field, enter: `admin' OR '1'='1' --`
3. Enter any password
4. Submit the form
5. The flag will be displayed in a modal

**Payload Examples:**
- `admin' OR '1'='1' --`
- `' UNION SELECT 1,2,3 --`
- `admin'; DROP TABLE users; --`

### 2. **Stored XSS** - Contact Form
- **Location**: Contact page (`/contact.html`)
- **Vulnerability**: Unsanitized HTML input in message field
- **Flag**: `THM{STORED_XSS_SUCCESS}`

**Exploitation:**
1. Go to the contact page
2. Fill out the contact form
3. In the message field, enter: `<script>alert('XSS')</script>`
4. Submit the form
5. The flag will be displayed in a modal

**Payload Examples:**
- `<script>alert('XSS')</script>`
- `<img src=x onerror=alert('XSS')>`
- `javascript:alert('XSS')`

### 3. **IDOR (Insecure Direct Object Reference)** - Profile Editing
- **Location**: Profile page (`/profile.html`)
- **Vulnerability**: No authorization check for profile updates
- **Flag**: `THM{IDOR_EXPLOIT_SUCCESS}`

**Exploitation:**
1. Login to the application
2. Go to the profile page
3. Open browser developer tools (F12)
4. In the console, execute:
   ```javascript
   fetch('/api/user/profile', {
       method: 'PUT',
       headers: {'Content-Type': 'application/json'},
       body: JSON.stringify({id: 2, firstName: 'Hacked'})
   }).then(r => r.json()).then(console.log)
   ```
5. The flag will be displayed

### 4. **CSRF (Cross-Site Request Forgery)** - Order Deletion
- **Location**: Orders page (`/orders.html`)
- **Vulnerability**: Missing CSRF token validation
- **Flag**: `THM{CSRF_EXPLOIT_SUCCESS}`

**Exploitation:**
1. Login to the application
2. Go to the orders page
3. Click the "Delete" button on any order
4. The flag will be displayed in a modal

**Alternative Method:**
Create an HTML file with:
```html
<html>
<body>
<script>
fetch('http://localhost:5000/api/orders/1', {
    method: 'DELETE',
    headers: {'Content-Type': 'application/json'}
}).then(r => r.json()).then(console.log)
</script>
</body>
</html>
```

## Setup Instructions

### Prerequisites
- Python 3.7+
- pip

### Installation
1. **Install dependencies:**
   ```bash
   pip install -r requirements.txt
   ```

2. **Run the application:**
   ```bash
   python app.py
   ```

3. **Access the application:**
   ```
   http://localhost:5000
   ```

### Demo Account
- **Email**: john@example.com
- **Password**: password123

## Flag Summary

| Vulnerability | Flag | Location |
|---------------|------|----------|
| SQL Injection | `THM{SQL_INJECTION_SUCCESS}` | Login form |
| Stored XSS | `THM{STORED_XSS_SUCCESS}` | Contact form |
| IDOR | `THM{IDOR_EXPLOIT_SUCCESS}` | Profile editing |
| CSRF | `THM{CSRF_EXPLOIT_SUCCESS}` | Order deletion |

## Educational Objectives

This application is designed to teach:

1. **SQL Injection Prevention**
   - Parameterized queries
   - Input validation
   - Output encoding

2. **XSS Prevention**
   - Input sanitization
   - Output encoding
   - Content Security Policy (CSP)

3. **Access Control**
   - Proper authorization checks
   - User session validation
   - Resource ownership verification

4. **CSRF Prevention**
   - CSRF tokens
   - SameSite cookies
   - Origin validation

## TryHackMe Room Integration

### Room Setup
1. Deploy this application on a TryHackMe machine
2. Update the flags in `app.py` to match your room's flag format
3. Create tasks for each vulnerability
4. Provide hints for exploitation methods

### Task Examples
- **Task 1**: Find the SQL injection vulnerability in the login form
- **Task 2**: Exploit the stored XSS vulnerability in the contact form
- **Task 3**: Use IDOR to access another user's profile
- **Task 4**: Perform a CSRF attack to delete an order

## Security Notes

‚ö†Ô∏è **This application is intentionally vulnerable and should NEVER be deployed in production!**

The vulnerabilities are designed for educational purposes and include:
- Deliberate security flaws
- No input validation
- Missing authorization checks
- Unsafe coding practices

## File Structure

```
mobile_shop/
‚îú‚îÄ‚îÄ app.py                 # Flask backend with vulnerabilities
‚îú‚îÄ‚îÄ index.html             # Homepage
‚îú‚îÄ‚îÄ login.html             # Login page (SQL Injection)
‚îú‚îÄ‚îÄ register.html          # Registration page
‚îú‚îÄ‚îÄ products.html          # Products listing
‚îú‚îÄ‚îÄ product-detail.html    # Product details
‚îú‚îÄ‚îÄ profile.html           # User profile (IDOR)
‚îú‚îÄ‚îÄ orders.html            # Order history (CSRF)
‚îú‚îÄ‚îÄ contact.html           # Contact form (XSS)
‚îú‚îÄ‚îÄ script.js              # Frontend JavaScript
‚îú‚îÄ‚îÄ common.js              # Shared functions
‚îú‚îÄ‚îÄ requirements.txt       # Python dependencies
‚îî‚îÄ‚îÄ README.md             # This file
```

## Contributing

This is a training application. If you find additional vulnerabilities or want to add more educational content, feel free to contribute!

## License

This project is for educational purposes only. Use responsibly and only in authorized testing environments.

